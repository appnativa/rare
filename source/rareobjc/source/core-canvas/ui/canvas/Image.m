//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Code/Dev/appNativa/source/rareobjc/../rare/core-canvas/com/appnativa/rare/ui/canvas/Image.java
//
//  Created by decoteaud on 12/8/15.
//

#include "IOSIntArray.h"
#include "com/appnativa/rare/Platform.h"
#include "com/appnativa/rare/iPlatformAppContext.h"
#include "com/appnativa/rare/ui/UIImage.h"
#include "com/appnativa/rare/ui/aWidgetListener.h"
#include "com/appnativa/rare/ui/canvas/Image.h"
#include "com/appnativa/rare/viewer/iViewer.h"
#include "com/appnativa/rare/widget/iWidget.h"
#include "java/lang/Exception.h"

@implementation RAREImage

- (id)init {
  return [super init];
}

- (id)initWithNSString:(NSString *)src {
  if (self = [super init]) {
    [self setSrcWithNSString:src];
  }
  return self;
}

- (id)initWithRAREUIImage:(RAREUIImage *)image {
  if (self = [super init]) {
    self->image_ = image;
  }
  return self;
}

- (id)initWithInt:(int)width
          withInt:(int)height {
  if (self = [super init]) {
    image_ = [[RAREUIImage alloc] initWithInt:width withInt:height];
  }
  return self;
}

- (void)blur {
  [((RAREUIImage *) nil_chk(image_)) blurImage];
}

- (void)createReflectionWithInt:(int)y
                        withInt:(int)height
                      withFloat:(float)opacity
                        withInt:(int)gap {
  if (image_ != nil) {
    image_ = [image_ createReflectionImageWithInt:y withInt:height withFloat:opacity withInt:gap];
  }
}

- (void)imageLoadedWithRAREUIImage:(RAREUIImage *)image {
}

- (void)setWithInt:(int)index
           withInt:(int)value {
  int w = [((RAREUIImage *) nil_chk(image_)) getWidth];
  [image_ setPixelWithInt:index / w withInt:index % (w + 1) withInt:value];
}

- (void)setContextWithRAREiWidget:(id<RAREiWidget>)context {
  self->context_ = context;
}

- (void)setOnabortWithId:(id)onabort {
  self->onabort_ = onabort;
}

- (void)setOnerrorWithId:(id)onerror {
  self->onerror_ = onerror;
}

- (void)setOnloadWithId:(id)onload {
  self->onload_ = onload;
}

- (void)setPixelsWithIntArray:(IOSIntArray *)pixels
                      withInt:(int)x
                      withInt:(int)y
                      withInt:(int)width
                      withInt:(int)height {
  [((RAREUIImage *) nil_chk(image_)) setPixelsWithIntArray:pixels withInt:x withInt:y withInt:width withInt:height];
}

- (void)setSrcWithNSString:(NSString *)src {
  self->src_ = src;
  if (src != nil) {
    @try {
      image_ = [((id<RAREiViewer>) nil_chk([RAREPlatform getContextRootViewer])) getImageWithNSString:src];
      if (onload_ != nil) {
        [self executeEventWithNSString:[NSString stringWithFormat:@"%@_onLoad", src] withId:onload_];
      }
    }
    @catch (JavaLangException *e) {
      [self executeEventWithNSString:[NSString stringWithFormat:@"%@_onError", src] withId:onerror_];
    }
  }
}

- (int)getWithInt:(int)index {
  int w = [((RAREUIImage *) nil_chk(image_)) getWidth];
  return [image_ getPixelWithInt:index / w withInt:index % (w + 1)];
}

- (id<RAREiWidget>)getContext {
  return (context_ != nil) ? ((id) context_) : ((id) [RAREPlatform getContextRootViewer]);
}

- (int)getHeight {
  return (image_ == nil) ? 0 : [image_ getHeight];
}

- (RAREUIImage *)getImage {
  return image_;
}

- (RAREUIImage *)getImageWithInt:(int)x
                         withInt:(int)y
                         withInt:(int)width
                         withInt:(int)height {
  if (image_ == nil) {
    return nil;
  }
  return [((RAREUIImage *) nil_chk(image_)) getSubimageWithInt:x withInt:y withInt:width withInt:height];
}

- (id)getOnabort {
  return onabort_;
}

- (id)getOnerror {
  return onerror_;
}

- (id)getOnload {
  return onload_;
}

- (IOSIntArray *)getPixels {
  if (pixelData_ == nil) {
    int w = [((RAREUIImage *) nil_chk(image_)) getWidth];
    int h = [image_ getHeight];
    pixelData_ = [IOSIntArray arrayWithLength:w * h];
    (void) [image_ getPixelsWithIntArray:pixelData_ withInt:0 withInt:0 withInt:w withInt:h];
  }
  return pixelData_;
}

- (IOSIntArray *)getPixelsWithInt:(int)x
                          withInt:(int)y
                          withInt:(int)width
                          withInt:(int)height {
  IOSIntArray *pixels = [IOSIntArray arrayWithLength:width * height];
  (void) [((RAREUIImage *) nil_chk(image_)) getPixelsWithIntArray:pixels withInt:x withInt:y withInt:width withInt:height];
  return pixels;
}

- (NSString *)getSrc {
  return src_;
}

- (int)getWidth {
  return (image_ == nil) ? 0 : [image_ getWidth];
}

- (void)executeEventWithNSString:(NSString *)event
                          withId:(id)code {
  if (event != nil) {
    id<RAREiPlatformAppContext> app = [((id<RAREiWidget>) nil_chk([self getContext])) getAppContext];
    [RAREaWidgetListener executeWithRAREiPlatformAppContext:app withNSString:event withId:code];
  }
}

- (void)copyAllFieldsTo:(RAREImage *)other {
  [super copyAllFieldsTo:other];
  other->context_ = context_;
  other->image_ = image_;
  other->onabort_ = onabort_;
  other->onerror_ = onerror_;
  other->onload_ = onload_;
  other->pixelData_ = pixelData_;
  other->src_ = src_;
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "getContext", NULL, "LRAREiWidget", 0x1, NULL },
    { "getImage", NULL, "LRAREUIImage", 0x1, NULL },
    { "getImageWithInt:withInt:withInt:withInt:", NULL, "LRAREUIImage", 0x1, NULL },
    { "getOnabort", NULL, "LNSObject", 0x1, NULL },
    { "getOnerror", NULL, "LNSObject", 0x1, NULL },
    { "getOnload", NULL, "LNSObject", 0x1, NULL },
    { "getPixels", NULL, "LIOSIntArray", 0x1, NULL },
    { "getPixelsWithInt:withInt:withInt:withInt:", NULL, "LIOSIntArray", 0x1, NULL },
    { "getSrc", NULL, "LNSString", 0x1, NULL },
    { "executeEventWithNSString:withId:", NULL, "V", 0x4, NULL },
  };
  static J2ObjcClassInfo _RAREImage = { "Image", "com.appnativa.rare.ui.canvas", NULL, 0x1, 10, methods, 0, NULL, 0, NULL};
  return &_RAREImage;
}

@end
