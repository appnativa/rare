//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Code/Dev/appNativa/source/rareobjc/../rare/apple/com/appnativa/rare/ExecutionHandler.java
//
//  Created by decoteaud on 9/15/15.
//

#include "com/appnativa/rare/ExecutionHandler.h"
#include "com/appnativa/rare/iCancelableFuture.h"
#include "com/appnativa/rare/iWorkerTask.h"
#include "com/appnativa/rare/platform/CancelableOperation.h"
#include "java/lang/Runnable.h"
#include "java/util/concurrent/Callable.h"

@implementation RAREExecutionHandler

- (id)initWithInt:(int)threads {
  if (self = [super init]) {
    tasksQueue_ = [self createProxyWithInt:threads];
  }
  return self;
}

- (id<RAREiCancelableFuture>)executeBackgroundTaskWithJavaUtilConcurrentCallable:(id<JavaUtilConcurrentCallable>)callable {
  RARECancelableOperation *op = [RARECancelableOperation createWithJavaUtilConcurrentCallable:callable];
  [self enqueueWithId:tasksQueue_ withRARECancelableOperation:op];
  return op;
}

- (id<RAREiCancelableFuture>)executeWorkerTaskWithRAREiWorkerTask:(id<RAREiWorkerTask>)task {
  RARECancelableOperation *op = [RARECancelableOperation createWithRAREiWorkerTask:task];
  [self enqueueWithId:tasksQueue_ withRARECancelableOperation:op];
  return op;
}

- (id<RAREiCancelableFuture>)executeBackgroundTaskWithJavaLangRunnable:(id<JavaLangRunnable>)runnable {
  RARECancelableOperation *op = [RARECancelableOperation createWithJavaLangRunnable:runnable];
  [self enqueueWithId:tasksQueue_ withRARECancelableOperation:op];
  return op;
}

- (id)createProxyWithInt:(int)threads {
  NSOperationQueue* queue=[[NSOperationQueue alloc] init];
  [queue setMaxConcurrentOperationCount: threads];
  return queue;
}

- (void)enqueueWithId:(id)queue
withRARECancelableOperation:(RARECancelableOperation *)cop {
  [((NSOperationQueue*)queue) addOperation:(NSOperation*)cop->proxy_];
}

- (void)copyAllFieldsTo:(RAREExecutionHandler *)other {
  [super copyAllFieldsTo:other];
  other->tasksQueue_ = tasksQueue_;
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "executeBackgroundTaskWithJavaUtilConcurrentCallable:", NULL, "LRAREiCancelableFuture", 0x1, NULL },
    { "executeWorkerTaskWithRAREiWorkerTask:", NULL, "LRAREiCancelableFuture", 0x1, NULL },
    { "executeBackgroundTaskWithJavaLangRunnable:", NULL, "LRAREiCancelableFuture", 0x1, NULL },
    { "createProxyWithInt:", NULL, "LNSObject", 0x102, NULL },
    { "enqueueWithId:withRARECancelableOperation:", NULL, "V", 0x102, NULL },
  };
  static J2ObjcFieldInfo fields[] = {
    { "tasksQueue_", NULL, 0x0, "LNSObject" },
  };
  static J2ObjcClassInfo _RAREExecutionHandler = { "ExecutionHandler", "com.appnativa.rare", NULL, 0x1, 5, methods, 1, fields, 0, NULL};
  return &_RAREExecutionHandler;
}

@end
