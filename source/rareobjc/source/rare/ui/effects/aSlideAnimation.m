//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Code/Dev/appNativa/source/rareobjc/../rare/core/com/appnativa/rare/ui/effects/aSlideAnimation.java
//
//  Created by decoteaud on 12/8/15.
//

#include "com/appnativa/rare/ui/AnimationComponent.h"
#include "com/appnativa/rare/ui/UIImage.h"
#include "com/appnativa/rare/ui/UIRectangle.h"
#include "com/appnativa/rare/ui/effects/aAnimator.h"
#include "com/appnativa/rare/ui/effects/aSlideAnimation.h"
#include "com/appnativa/rare/ui/effects/iAnimator.h"
#include "com/appnativa/rare/ui/effects/iTransitionSupport.h"
#include "com/appnativa/rare/ui/iPlatformComponent.h"
#include "com/appnativa/util/SNumber.h"
#include "java/lang/Boolean.h"
#include "java/util/Map.h"

@implementation RAREaSlideAnimation

- (id)init {
  return [self initRAREaSlideAnimationWithBoolean:YES withBoolean:YES];
}

- (id)initWithBoolean:(BOOL)horizontal {
  return [self initRAREaSlideAnimationWithBoolean:horizontal withBoolean:YES];
}

- (id)initRAREaSlideAnimationWithBoolean:(BOOL)horizontal
                             withBoolean:(BOOL)fromLeftOrTop {
  if (self = [super init]) {
    horizontal_ = YES;
    percent_ = 1.0f;
    self->horizontal_ = horizontal;
    [self setDirectionWithRAREiAnimator_DirectionEnum:fromLeftOrTop ? [RAREiAnimator_DirectionEnum BACKWARD] : [RAREiAnimator_DirectionEnum FORWARD]];
  }
  return self;
}

- (id)initWithBoolean:(BOOL)horizontal
          withBoolean:(BOOL)fromLeftOrTop {
  return [self initRAREaSlideAnimationWithBoolean:horizontal withBoolean:fromLeftOrTop];
}

- (void)clear {
  [super clear];
  outComponent_ = nil;
  inComponent_ = nil;
}

- (void)animateToWithRAREiPlatformComponent:(id<RAREiPlatformComponent>)c
                                  withFloat:(float)x
                                  withFloat:(float)y {
  RAREUIRectangle *from = [((id<RAREiPlatformComponent>) nil_chk(c)) getBounds];
  RAREUIRectangle *to = [[RAREUIRectangle alloc] initWithFloat:x withFloat:y withFloat:((RAREUIRectangle *) nil_chk(from))->width_ withFloat:from->height_];
  locationChanger_ = [[RAREaAnimator_BoundsChanger alloc] initWithRAREUIRectangle:from withRAREUIRectangle:to];
  [super animateWithRAREiPlatformComponent:c withId:postAnimateAction_];
}

- (void)animateWithRAREiPlatformComponent:(id<RAREiPlatformComponent>)c
                                   withId:(id)postAnimateAction {
  RAREUIRectangle *from = [((id<RAREiPlatformComponent>) nil_chk(c)) getBounds];
  float size = horizontal_ ? ((RAREUIRectangle *) nil_chk(from))->width_ : ((RAREUIRectangle *) nil_chk(from))->height_;
  float x = ((RAREUIRectangle *) nil_chk(from))->x_;
  float y = from->y_;
  if ([(id) c isKindOfClass:[RAREAnimationComponent class]]) {
    size /= 2;
  }
  if (percent_ < 1) {
    size = size * percent_;
  }
  BOOL fromLeftOrTop = direction_ == [RAREiAnimator_DirectionEnum BACKWARD];
  if (horizontal_) {
    if (fromLeftOrTop) {
      x += size;
    }
    else {
      x -= size;
    }
  }
  else {
    if (fromLeftOrTop) {
      y += size;
    }
    else {
      y -= size;
    }
  }
  RAREUIRectangle *to = [[RAREUIRectangle alloc] initWithFloat:x withFloat:y withFloat:from->width_ withFloat:from->height_];
  locationChanger_ = [[RAREaAnimator_BoundsChanger alloc] initWithRAREUIRectangle:from withRAREUIRectangle:to];
  [super animateWithRAREiPlatformComponent:c withId:postAnimateAction];
}

- (void)handlePropertiesWithJavaUtilMap:(id<JavaUtilMap>)map {
  [super handlePropertiesWithJavaUtilMap:map];
  if (map == nil) {
    return;
  }
  id o = [((id<JavaUtilMap>) nil_chk(map)) getWithId:@"horizontal"];
  if ([o isKindOfClass:[JavaLangBoolean class]]) {
    [self setHorizontalWithBoolean:[((JavaLangBoolean *) check_class_cast(o, [JavaLangBoolean class])) booleanValue]];
  }
  else if ([o isKindOfClass:[NSString class]]) {
    [self setHorizontalWithBoolean:[@"true" equalsIgnoreCase:(NSString *) check_class_cast(o, [NSString class])]];
  }
}

- (void)setFadeInWithBoolean:(BOOL)fade {
  self->fadeIn_ = fade;
}

- (void)setFadeOutWithBoolean:(BOOL)fade {
  self->fadeOut_ = fade;
}

- (void)setHorizontalWithBoolean:(BOOL)horizontal {
  self->horizontal_ = horizontal;
}

- (void)setOutgoingComponentWithRAREiPlatformComponent:(id<RAREiPlatformComponent>)outComponent
                                       withRAREUIImage:(RAREUIImage *)outImage {
  [super setOutgoingComponentWithRAREiPlatformComponent:outComponent withRAREUIImage:outImage];
  self->outComponent_ = outComponent;
}

- (id<RAREiPlatformComponent>)setIncommingComponentWithRAREiPlatformComponent:(id<RAREiPlatformComponent>)inComponent {
  self->inComponent_ = inComponent;
  return inComponent;
}

- (void)setPercentWithFloat:(float)percent {
  self->percent_ = percent;
}

- (void)setTransitionTypeWithRAREiTransitionSupport_TransitionTypeEnum:(RAREiTransitionSupport_TransitionTypeEnum *)type {
  horizontal_ = type == [RAREiTransitionSupport_TransitionTypeEnum HORIZONTAL];
}

- (RAREiTransitionSupport_TransitionTypeEnum *)getTransitionType {
  return horizontal_ ? [RAREiTransitionSupport_TransitionTypeEnum HORIZONTAL] : [RAREiTransitionSupport_TransitionTypeEnum VERTICAL];
}

- (BOOL)isHorizontal {
  return horizontal_;
}

- (void)handleCustomPropertiesWithJavaUtilMap:(id<JavaUtilMap>)map {
  [super handleCustomPropertiesWithJavaUtilMap:map];
  id o = [((id<JavaUtilMap>) nil_chk(map)) getWithId:@"percent"];
  float p = 0;
  if ([o isKindOfClass:[NSNumber class]]) {
    p = [((NSNumber *) check_class_cast(o, [NSNumber class])) floatValue];
  }
  else if ([o isKindOfClass:[NSString class]]) {
    p = [RAREUTSNumber floatValueWithNSString:(NSString *) check_class_cast(o, [NSString class])];
  }
  if (p > 1) {
    p = p / 100.0f;
    if (p > 1) {
      p = 1;
    }
  }
  if (p > 0) {
    percent_ = p;
  }
}

- (void)restoreComponentWithRAREiPlatformComponent:(id<RAREiPlatformComponent>)comp {
  [((id<RAREiPlatformComponent>) nil_chk(comp)) setAlphaWithFloat:1.0f];
}

- (BOOL)isComponentDisposed {
  if (((component_ != nil) && [component_ isDisposed])) {
    return YES;
  }
  if (((inComponent_ != nil) && [inComponent_ isDisposed])) {
    return YES;
  }
  if (((outComponent_ != nil) && [outComponent_ isDisposed])) {
    return YES;
  }
  return NO;
}

- (void)updateWithFloat:(float)fraction {
  float x;
  float y;
  if (horizontal_) {
    y = ((RAREUIRectangle *) nil_chk(((RAREaAnimator_BoundsChanger *) nil_chk(locationChanger_))->to_))->y_;
    x = [locationChanger_ getXWithFloat:fraction];
  }
  else {
    x = ((RAREUIRectangle *) nil_chk(((RAREaAnimator_BoundsChanger *) nil_chk(locationChanger_))->to_))->x_;
    y = [locationChanger_ getYWithFloat:fraction];
  }
  if (outComponent_ == component_) {
    [((id<RAREiPlatformComponent>) nil_chk(outComponent_)) setLocationWithFloat:x withFloat:y];
    if (direction_ == [RAREiAnimator_DirectionEnum FORWARD]) {
      x += horizontal_ ? [outComponent_ getWidth] : 0;
      y += horizontal_ ? 0 : [outComponent_ getHeight];
      [((id<RAREiPlatformComponent>) nil_chk(inComponent_)) setLocationWithFloat:x withFloat:y];
    }
    else {
      x -= horizontal_ ? [outComponent_ getWidth] : 0;
      y -= horizontal_ ? y : [outComponent_ getHeight];
      [((id<RAREiPlatformComponent>) nil_chk(inComponent_)) setLocationWithFloat:x withFloat:y];
    }
  }
  else {
    [((id<RAREiPlatformComponent>) nil_chk(component_)) setLocationWithFloat:x withFloat:y];
  }
  if (fadeOut_ && (outComponent_ != nil)) {
    [outComponent_ setAlphaWithFloat:1 - fraction];
    [outComponent_ repaint];
  }
  if (fadeIn_ && (inComponent_ != nil)) {
    [inComponent_ setAlphaWithFloat:fraction];
    [inComponent_ repaint];
  }
}

- (void)copyAllFieldsTo:(RAREaSlideAnimation *)other {
  [super copyAllFieldsTo:other];
  other->horizontal_ = horizontal_;
  other->inComponent_ = inComponent_;
  other->locationChanger_ = locationChanger_;
  other->outComponent_ = outComponent_;
  other->percent_ = percent_;
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "clear", NULL, "V", 0x4, NULL },
    { "setIncommingComponentWithRAREiPlatformComponent:", NULL, "LRAREiPlatformComponent", 0x1, NULL },
    { "getTransitionType", NULL, "LRAREiTransitionSupport_TransitionTypeEnum", 0x1, NULL },
    { "isHorizontal", NULL, "Z", 0x1, NULL },
    { "handleCustomPropertiesWithJavaUtilMap:", NULL, "V", 0x4, NULL },
    { "isComponentDisposed", NULL, "Z", 0x4, NULL },
    { "updateWithFloat:", NULL, "V", 0x4, NULL },
  };
  static J2ObjcFieldInfo fields[] = {
    { "horizontal_", NULL, 0x4, "Z" },
    { "percent_", NULL, 0x4, "F" },
    { "outComponent_", NULL, 0x4, "LRAREiPlatformComponent" },
    { "locationChanger_", NULL, 0x0, "LRAREaAnimator_BoundsChanger" },
    { "inComponent_", NULL, 0x4, "LRAREiPlatformComponent" },
  };
  static J2ObjcClassInfo _RAREaSlideAnimation = { "aSlideAnimation", "com.appnativa.rare.ui.effects", NULL, 0x401, 7, methods, 5, fields, 0, NULL};
  return &_RAREaSlideAnimation;
}

@end
