//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Code/Dev/appNativa/source/rareobjc/../rare/core/com/appnativa/rare/ui/effects/aFadeAnimation.java
//
//  Created by decoteaud on 9/15/15.
//

#include "com/appnativa/rare/platform/PlatformHelper.h"
#include "com/appnativa/rare/ui/UIImage.h"
#include "com/appnativa/rare/ui/effects/aFadeAnimation.h"
#include "com/appnativa/rare/ui/effects/aPlatformAnimator.h"
#include "com/appnativa/rare/ui/effects/iAnimator.h"
#include "com/appnativa/rare/ui/effects/iTransitionSupport.h"
#include "com/appnativa/rare/ui/iParentComponent.h"
#include "com/appnativa/rare/ui/iPlatformComponent.h"
#include "com/appnativa/util/SNumber.h"
#include "java/util/Map.h"

@implementation RAREaFadeAnimation

- (id)init {
  if (self = [super init]) {
    endingAlpha_ = 1.0f;
    [self setDurationWithInt:500];
  }
  return self;
}

- (void)setFadeInWithBoolean:(BOOL)fade {
  self->fadeIn_ = fade;
}

- (void)setFadeOutWithBoolean:(BOOL)fade {
  self->fadeOut_ = fade;
}

- (id<RAREiPlatformComponent>)setIncommingComponentWithRAREiPlatformComponent:(id<RAREiPlatformComponent>)inComponent {
  self->inComponent_ = inComponent;
  return inComponent;
}

- (void)setOutgoingComponentWithRAREiPlatformComponent:(id<RAREiPlatformComponent>)outComponent
                                       withRAREUIImage:(RAREUIImage *)outImage {
  self->outComponent_ = outComponent;
}

- (void)setTransitionTypeWithRAREiTransitionSupport_TransitionTypeEnum:(RAREiTransitionSupport_TransitionTypeEnum *)type {
}

- (RAREiTransitionSupport_TransitionTypeEnum *)getTransitionType {
  return [RAREiTransitionSupport_TransitionTypeEnum STACK];
}

- (void)clear {
  if (inComponent_ != nil) {
    [RAREPlatformHelper setComponentAlphaWithRAREiPlatformComponent:inComponent_ withFloat:1];
  }
  else if (component_ != nil) {
    [RAREPlatformHelper setComponentAlphaWithRAREiPlatformComponent:component_ withFloat:1];
  }
  outComponent_ = nil;
  outComponent_ = nil;
}

- (void)handleCustomPropertiesWithJavaUtilMap:(id<JavaUtilMap>)map {
  [super handleCustomPropertiesWithJavaUtilMap:map];
  id o = [((id<JavaUtilMap>) nil_chk(map)) getWithId:@"startAlpha"];
  float start = 0;
  if ([o isKindOfClass:[NSNumber class]]) {
    start = [((NSNumber *) check_class_cast(o, [NSNumber class])) floatValue];
  }
  else if ([o isKindOfClass:[NSString class]]) {
    start = [RAREUTSNumber floatValueWithNSString:(NSString *) check_class_cast(o, [NSString class])];
  }
  if (start > 1) {
    start = start / 100.0f;
    if (start > 1) {
      start = 1;
    }
  }
  o = [map getWithId:@"endAlpha"];
  float end = 1;
  if ([o isKindOfClass:[NSNumber class]]) {
    end = [((NSNumber *) check_class_cast(o, [NSNumber class])) floatValue];
  }
  else if ([o isKindOfClass:[NSString class]]) {
    end = [RAREUTSNumber floatValueWithNSString:(NSString *) check_class_cast(o, [NSString class])];
  }
  if (end > 1) {
    end = end / 100.0f;
    if (end > 1) {
      end = 1;
    }
  }
  startingAlpha_ = start;
  endingAlpha_ = end;
}

- (void)updateWithFloat:(float)value {
  value = startingAlpha_ + ((endingAlpha_ - startingAlpha_) * value);
  if ((component_ == nil) || [component_ isDisposed] || ([component_ getParent] == nil) || ((inComponent_ != nil) && [inComponent_ isDisposed])) {
    [self cancel];
    return;
  }
  if ((inComponent_ != nil) && (outComponent_ != nil)) {
    if (![RAREPlatformHelper setComponentAlphaWithRAREiPlatformComponent:inComponent_ withFloat:value]) {
      [self cancel];
      return;
    }
    [inComponent_ repaint];
    if ([RAREPlatformHelper setComponentAlphaWithRAREiPlatformComponent:outComponent_ withFloat:endingAlpha_ - value]) {
      [outComponent_ repaint];
    }
  }
  else {
    if (direction_ == [RAREiAnimator_DirectionEnum FORWARD]) {
      [RAREPlatformHelper setComponentAlphaWithRAREiPlatformComponent:component_ withFloat:value];
    }
    else {
      [RAREPlatformHelper setComponentAlphaWithRAREiPlatformComponent:component_ withFloat:endingAlpha_ - value];
    }
    [((id<RAREiPlatformComponent>) nil_chk(component_)) repaint];
  }
  [((id<RAREiPlatformComponent>) nil_chk(component_)) repaint];
}

- (BOOL)isComponentDisposed {
  if (((component_ != nil) && [component_ isDisposed])) {
    return YES;
  }
  if (((inComponent_ != nil) && [inComponent_ isDisposed])) {
    return YES;
  }
  if (((outComponent_ != nil) && [outComponent_ isDisposed])) {
    return YES;
  }
  return NO;
}

- (void)restoreComponentWithRAREiPlatformComponent:(id<RAREiPlatformComponent>)comp {
  [RAREPlatformHelper setComponentAlphaWithRAREiPlatformComponent:comp withFloat:1.0f];
}

- (float)getStartingAlpha {
  return startingAlpha_;
}

- (void)setStartingAlphaWithFloat:(float)alpha {
  self->startingAlpha_ = alpha;
}

- (float)getEndingAlpha {
  return endingAlpha_;
}

- (void)setEndingAlphaWithFloat:(float)endingAlpha {
  self->endingAlpha_ = endingAlpha;
}

- (void)copyAllFieldsTo:(RAREaFadeAnimation *)other {
  [super copyAllFieldsTo:other];
  other->endingAlpha_ = endingAlpha_;
  other->inComponent_ = inComponent_;
  other->outComponent_ = outComponent_;
  other->startingAlpha_ = startingAlpha_;
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "setIncommingComponentWithRAREiPlatformComponent:", NULL, "LRAREiPlatformComponent", 0x1, NULL },
    { "getTransitionType", NULL, "LRAREiTransitionSupport_TransitionTypeEnum", 0x1, NULL },
    { "clear", NULL, "V", 0x4, NULL },
    { "handleCustomPropertiesWithJavaUtilMap:", NULL, "V", 0x4, NULL },
    { "updateWithFloat:", NULL, "V", 0x4, NULL },
    { "isComponentDisposed", NULL, "Z", 0x4, NULL },
  };
  static J2ObjcFieldInfo fields[] = {
    { "inComponent_", NULL, 0x4, "LRAREiPlatformComponent" },
    { "outComponent_", NULL, 0x4, "LRAREiPlatformComponent" },
    { "startingAlpha_", NULL, 0x4, "F" },
    { "endingAlpha_", NULL, 0x4, "F" },
  };
  static J2ObjcClassInfo _RAREaFadeAnimation = { "aFadeAnimation", "com.appnativa.rare.ui.effects", NULL, 0x401, 6, methods, 4, fields, 0, NULL};
  return &_RAREaFadeAnimation;
}

@end
