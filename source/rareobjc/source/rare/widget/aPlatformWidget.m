//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Code/Dev/appNativa/source/rareobjc/../rare/apple/com/appnativa/rare/widget/aPlatformWidget.java
//
//  Created by decoteaud on 9/15/15.
//

#include "com/appnativa/rare/Platform.h"
#include "com/appnativa/rare/iConstants.h"
#include "com/appnativa/rare/iPlatformAppContext.h"
#include "com/appnativa/rare/platform/apple/ui/util/ImageUtils.h"
#include "com/appnativa/rare/platform/apple/ui/view/PopupWindow.h"
#include "com/appnativa/rare/platform/apple/ui/view/View.h"
#include "com/appnativa/rare/scripting/iScriptHandler.h"
#include "com/appnativa/rare/spot/Widget.h"
#include "com/appnativa/rare/ui/Component.h"
#include "com/appnativa/rare/ui/ContainerPanel.h"
#include "com/appnativa/rare/ui/RenderableDataItem.h"
#include "com/appnativa/rare/ui/UIImage.h"
#include "com/appnativa/rare/ui/UIPopupMenu.h"
#include "com/appnativa/rare/ui/WidgetListener.h"
#include "com/appnativa/rare/ui/aWidgetListener.h"
#include "com/appnativa/rare/ui/event/KeyEvent.h"
#include "com/appnativa/rare/ui/event/MouseEvent.h"
#include "com/appnativa/rare/ui/iActionable.h"
#include "com/appnativa/rare/ui/iPlatformComponent.h"
#include "com/appnativa/rare/ui/iPopup.h"
#include "com/appnativa/rare/ui/painter/iPainterSupport.h"
#include "com/appnativa/rare/viewer/iContainer.h"
#include "com/appnativa/rare/widget/aPlatformWidget.h"
#include "com/appnativa/rare/widget/aWidget.h"
#include "com/appnativa/rare/widget/iWidget.h"
#include "com/appnativa/spot/SPOTSet.h"
#include "java/util/ArrayList.h"
#include "java/util/Map.h"

@implementation RAREaPlatformWidget

static RAREaPlatformWidget_MenuMouseListener * RAREaPlatformWidget_menuMouseListener__;

+ (RAREaPlatformWidget_MenuMouseListener *)menuMouseListener_ {
  return RAREaPlatformWidget_menuMouseListener__;
}

+ (void)setMenuMouseListener_:(RAREaPlatformWidget_MenuMouseListener *)menuMouseListener_ {
  RAREaPlatformWidget_menuMouseListener__ = menuMouseListener_;
}

- (id)initWithRAREiContainer:(id<RAREiContainer>)parent {
  return [super initWithRAREiContainer:parent];
}

- (void)buzz {
}

- (RAREUIImage *)capture {
  return [RAREImageUtils createImageWithRAREiPlatformComponent:[self getContainerComponent]];
}

- (void)focusNextWidget {
  if ([self isFocusOwner]) {
    [((RAREView *) nil_chk([self getDataView])) focusNextView];
  }
}

- (void)focusPreviousWidget {
  if ([self isFocusOwner]) {
    [((RAREView *) nil_chk([self getDataView])) focusPreviousView];
  }
}

- (void)handleKeyboardActionsWithRAREKeyEvent:(RAREKeyEvent *)e {
  [((id<RAREiPlatformComponent>) nil_chk([self getDataComponent])) dispatchEventWithRAREKeyEvent:e];
}

- (void)hidePopupContainer {
  if ([self isDisposed]) {
    return;
  }
  if (popupContainer_ != nil) {
    [popupContainer_ hidePopup];
  }
  else {
    RAREView *v = [self getContainerView];
    RAREView *vp = [((RAREView *) nil_chk(v)) getParent];
    while (vp != nil) {
      if ([vp isKindOfClass:[RAREPopupWindow class]]) {
        [((RAREPopupWindow *) check_class_cast(vp, [RAREPopupWindow class])) hidePopup];
        return;
      }
      vp = [((RAREView *) nil_chk(vp)) getParent];
    }
  }
}

- (BOOL)requestFocus {
  return [((RAREView *) nil_chk([self getDataView])) requestFocus];
}

- (void)showPopupMenuWithInt:(int)x
                     withInt:(int)y {
  RAREUIPopupMenu *menu = [self getPopupMenu];
  if (menu != nil) {
    [menu showWithRAREiWidget:self withBoolean:[RAREPlatform isTouchDevice]];
  }
}

- (RAREComponent *)getContainerComponentEx {
  return (RAREComponent *) check_class_cast([self getContainerComponent], [RAREComponent class]);
}

- (RAREView *)getContainerView {
  return [((RAREComponent *) nil_chk([self getContainerComponentEx])) getView];
}

- (RAREView *)getDataView {
  return [((RAREComponent *) nil_chk([self getDataComponentEx])) getView];
}

- (BOOL)getHasPainterSupport {
  if ([(id) [self getDataComponent] conformsToProtocol: @protocol(RAREiPainterSupport)]) {
    return YES;
  }
  return [(id) [self getContainerComponent] conformsToProtocol: @protocol(RAREiPainterSupport)];
}

+ (id<RAREiWidget>)getWidgetForViewWithRAREView:(RAREView *)view {
  id<RAREiPlatformComponent> c = (view == nil) ? nil : [RAREComponent fromViewWithRAREView:view];
  if (c != nil) {
    return [c getWidget];
  }
  return nil;
}

- (BOOL)isFocusOwner {
  id<RAREiPlatformComponent> fc = [((id<RAREiPlatformAppContext>) nil_chk([RAREPlatform getAppContext])) getFocusOwner];
  if (fc == nil) {
    return NO;
  }
  id<RAREiPlatformComponent> cc = [self getContainerComponent];
  if ((cc == fc) || (fc == [self getDataComponent])) {
    return YES;
  }
  return [((RAREView *) nil_chk([((id<RAREiPlatformComponent>) nil_chk(fc)) getView])) isDescendantOfWithRAREView:[((id<RAREiPlatformComponent>) nil_chk(cc)) getView]];
}

- (BOOL)isInPopup {
  if ([self isDisposed]) {
    return NO;
  }
  RAREView *v = [self getContainerView];
  RAREView *vp = [((RAREView *) nil_chk(v)) getParent];
  while (vp != nil) {
    if ([vp isKindOfClass:[RAREPopupWindow class]]) {
      return YES;
    }
    if ([vp isKindOfClass:[RAREView class]]) {
      vp = [((RAREView *) nil_chk(vp)) getParent];
    }
    else {
      vp = nil;
    }
  }
  return NO;
}

- (void)configureMenusWithRAREiPlatformComponent:(id<RAREiPlatformComponent>)comp
                              withRARESPOTWidget:(RARESPOTWidget *)cfg
                                     withBoolean:(BOOL)textMenus {
  SPOTSet *menu = [((RARESPOTWidget *) nil_chk(cfg)) getPopupMenu];
  if (menu != nil) {
    popupMenu_ = [[RAREUIPopupMenu alloc] initWithRAREiWidget:self withSPOTSet:menu];
  }
}

- (RAREaWidgetListener *)createWidgetListenerWithRAREiWidget:(id<RAREiWidget>)widget
                                             withJavaUtilMap:(id<JavaUtilMap>)map
                                      withRAREiScriptHandler:(id<RAREiScriptHandler>)scriptHandler {
  return [[RAREWidgetListener alloc] initWithRAREiWidget:widget withJavaUtilMap:map withRAREiScriptHandler:scriptHandler];
}

- (void)setEventHandlerWithNSString:(NSString *)event
                             withId:(id)code
                        withBoolean:(BOOL)append {
  [super setEventHandlerWithNSString:event withId:code withBoolean:append];
  NSString *se = [RAREaWidgetListener fromWebEventExWithNSString:event];
  if (se != nil) {
    event = se;
  }
  RAREWidgetListener *l = (RAREWidgetListener *) check_class_cast([self getWidgetListener], [RAREWidgetListener class]);
  if ([RAREPlatform isTouchableDevice]) {
    if ([((RAREWidgetListener *) nil_chk(l)) isEnabledWithNSString:[RAREiConstants EVENT_SCALE]]) {
      [((RAREComponent *) nil_chk([self getDataComponentEx])) addScaleListenerWithRAREiGestureListener:l];
    }
    if ([l isEnabledWithNSString:[RAREiConstants EVENT_FLING]] || [l isEnabledWithNSString:[RAREiConstants EVENT_SCROLL]]) {
      [((RAREComponent *) nil_chk([self getDataComponentEx])) addFlingListenerWithRAREiGestureListener:l];
    }
    if ([l isEnabledWithNSString:[RAREiConstants EVENT_ROTATE]]) {
      [((RAREComponent *) nil_chk([self getDataComponentEx])) addRotateListenerWithRAREiGestureListener:l];
    }
  }
  if ([((RAREWidgetListener *) nil_chk(l)) isMouseEventsEnabled]) {
    [((RAREComponent *) nil_chk([self getDataComponentEx])) addMouseListenerWithRAREiMouseListener:l];
  }
  if ([l isMouseMotionEventsEnabled] || ([l isEnabledWithNSString:[RAREiConstants EVENT_SCALE]] && ![RAREPlatform isTouchDevice])) {
    [((RAREComponent *) nil_chk([self getDataComponentEx])) addMouseMotionListenerWithRAREiMouseMotionListener:l];
  }
}

- (void)initializeListenersWithRAREaWidgetListener:(RAREaWidgetListener *)listener {
  RAREWidgetListener *l = (RAREWidgetListener *) check_class_cast(listener, [RAREWidgetListener class]);
  [self initializePoupuMenuListenerWithRAREWidgetListener:l];
  if ([self conformsToProtocol: @protocol(RAREiActionable)]) {
    BOOL eventEnabled = (l != nil) && [l isActionEventEnabled];
    if (eventEnabled) {
      [((id<RAREiActionable>) check_protocol_cast(self, @protocol(RAREiActionable))) addActionListenerWithRAREiActionListener:l];
    }
    else {
      [((id<RAREiActionable>) check_protocol_cast(self, @protocol(RAREiActionable))) addActionListenerWithRAREiActionListener:self];
    }
  }
  if (l == nil) {
    return;
  }
  if ([((RAREWidgetListener *) nil_chk(l)) isKeyEventsEnabled]) {
    [((RAREComponent *) nil_chk([self getDataComponentEx])) addKeyListenerWithRAREiKeyListener:l];
  }
  if ([RAREPlatform isTouchableDevice]) {
    if ([l isEnabledWithNSString:[RAREiConstants EVENT_SCALE]]) {
      [((RAREComponent *) nil_chk([self getDataComponentEx])) addScaleListenerWithRAREiGestureListener:l];
    }
    if ([l isEnabledWithNSString:[RAREiConstants EVENT_FLING]] || [l isEnabledWithNSString:[RAREiConstants EVENT_SCROLL]]) {
      [((RAREComponent *) nil_chk([self getDataComponentEx])) addFlingListenerWithRAREiGestureListener:l];
    }
    if ([l isEnabledWithNSString:[RAREiConstants EVENT_ROTATE]]) {
      [((RAREComponent *) nil_chk([self getDataComponentEx])) addRotateListenerWithRAREiGestureListener:l];
    }
  }
  if ([l isMouseEventsEnabled]) {
    [((RAREComponent *) nil_chk([self getDataComponentEx])) addMouseListenerWithRAREiMouseListener:l];
  }
  if ([l isMouseMotionEventsEnabled] || ([l isEnabledWithNSString:[RAREiConstants EVENT_SCALE]] && ![RAREPlatform isTouchDevice])) {
    [((RAREComponent *) nil_chk([self getDataComponentEx])) addMouseMotionListenerWithRAREiMouseMotionListener:l];
  }
  if ([l isEnabledWithNSString:[RAREiConstants EVENT_FOCUS]] || [l isEnabledWithNSString:[RAREiConstants EVENT_BLUR]]) {
    [((RAREComponent *) nil_chk([self getDataComponentEx])) addFocusListenerWithRAREiFocusListener:l];
  }
  if ([l isEnabledWithNSString:[RAREiConstants EVENT_RESIZE]] || [l isEnabledWithNSString:[RAREiConstants EVENT_MOVED]] || [l isEnabledWithNSString:[RAREiConstants EVENT_SHOWN]] || [l isEnabledWithNSString:[RAREiConstants EVENT_HIDDEN]]) {
    [((RAREComponent *) nil_chk([self getContainerComponentEx])) addViewListenerWithRAREiViewListener:l];
  }
}

- (void)initializePoupuMenuListenerWithRAREWidgetListener:(RAREWidgetListener *)l {
  if ([self hasPopupMenu] || ((l != nil) && [l isEnabledWithNSString:[RAREiConstants EVENT_CONTEXTMENU]])) {
    if (RAREaPlatformWidget_menuMouseListener__ == nil) {
      RAREaPlatformWidget_menuMouseListener__ = [[RAREaPlatformWidget_MenuMouseListener alloc] init];
    }
    [((RAREComponent *) nil_chk([self getDataComponentEx])) addMouseListenerWithRAREiMouseListener:RAREaPlatformWidget_menuMouseListener__];
  }
}

- (RAREComponent *)getDataComponentEx {
  return (RAREComponent *) check_class_cast([self getDataComponent], [RAREComponent class]);
}

- (id<RAREiPainterSupport>)getPainterSupportWithBoolean:(BOOL)outer {
  RAREComponent *c1 = outer ? [self getContainerComponentEx] : [self getDataComponentEx];
  RAREComponent *c2 = outer ? [self getDataComponentEx] : [self getContainerComponentEx];
  if (outer && ([c1 isKindOfClass:[RAREContainerPanel class]]) && [((RAREContainerPanel *) check_class_cast(c1, [RAREContainerPanel class])) isBorderPanel]) {
    c1 = c2;
  }
  if ([c1 conformsToProtocol: @protocol(RAREiPainterSupport)]) {
    return c1;
  }
  if ([c2 conformsToProtocol: @protocol(RAREiPainterSupport)]) {
    return c2;
  }
  return nil;
}

- (void)copyAllFieldsTo:(RAREaPlatformWidget *)other {
  [super copyAllFieldsTo:other];
  other->designMode_ = designMode_;
}

- (NSUInteger)countByEnumeratingWithState:(NSFastEnumerationState *)state objects:(__unsafe_unretained id *)stackbuf count:(NSUInteger)len {
  return JreDefaultFastEnumeration(self, state, stackbuf, len);
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "initWithRAREiContainer:", NULL, NULL, 0x4, NULL },
    { "capture", NULL, "LRAREUIImage", 0x1, NULL },
    { "requestFocus", NULL, "Z", 0x1, NULL },
    { "getContainerComponentEx", NULL, "LRAREComponent", 0x1, NULL },
    { "getContainerView", NULL, "LRAREView", 0x1, NULL },
    { "getDataView", NULL, "LRAREView", 0x1, NULL },
    { "getHasPainterSupport", NULL, "Z", 0x1, NULL },
    { "getWidgetForViewWithRAREView:", NULL, "LRAREiWidget", 0x9, NULL },
    { "isFocusOwner", NULL, "Z", 0x1, NULL },
    { "isInPopup", NULL, "Z", 0x1, NULL },
    { "configureMenusWithRAREiPlatformComponent:withRARESPOTWidget:withBoolean:", NULL, "V", 0x4, NULL },
    { "createWidgetListenerWithRAREiWidget:withJavaUtilMap:withRAREiScriptHandler:", NULL, "LRAREaWidgetListener", 0x4, NULL },
    { "initializeListenersWithRAREaWidgetListener:", NULL, "V", 0x4, NULL },
    { "initializePoupuMenuListenerWithRAREWidgetListener:", NULL, "V", 0x4, NULL },
    { "getDataComponentEx", NULL, "LRAREComponent", 0x4, NULL },
    { "getPainterSupportWithBoolean:", NULL, "LRAREiPainterSupport", 0x4, NULL },
  };
  static J2ObjcFieldInfo fields[] = {
    { "menuMouseListener__", NULL, 0xa, "LRAREaPlatformWidget_MenuMouseListener" },
    { "designMode_", NULL, 0x4, "Z" },
  };
  static J2ObjcClassInfo _RAREaPlatformWidget = { "aPlatformWidget", "com.appnativa.rare.widget", NULL, 0x401, 16, methods, 2, fields, 0, NULL};
  return &_RAREaPlatformWidget;
}

@end
@implementation RAREaPlatformWidget_ItemAttributes

- (void)addCheckedWithRARERenderableDataItem:(RARERenderableDataItem *)item {
  if (check_ != nil) {
    if (checked_ == nil) {
      checked_ = [[JavaUtilArrayList alloc] initWithInt:5];
    }
    [((JavaUtilArrayList *) nil_chk(checked_)) addWithId:item];
  }
  else {
    check_ = item;
  }
}

- (void)addExpandedWithRARERenderableDataItem:(RARERenderableDataItem *)item {
  if (expand_ != nil) {
    if (expanded_ == nil) {
      expanded_ = [[JavaUtilArrayList alloc] initWithInt:5];
    }
    [((JavaUtilArrayList *) nil_chk(expanded_)) addWithId:item];
  }
  else {
    expand_ = item;
  }
}

- (void)addSelectedWithRARERenderableDataItem:(RARERenderableDataItem *)item {
  if (select_ != nil) {
    if (selected_ == nil) {
      selected_ = [[JavaUtilArrayList alloc] initWithInt:5];
    }
    [((JavaUtilArrayList *) nil_chk(selected_)) addWithId:item];
  }
  else {
    select_ = item;
  }
}

- (id)init {
  return [super init];
}

- (void)copyAllFieldsTo:(RAREaPlatformWidget_ItemAttributes *)other {
  [super copyAllFieldsTo:other];
  other->check_ = check_;
  other->checked_ = checked_;
  other->expand_ = expand_;
  other->expanded_ = expanded_;
  other->select_ = select_;
  other->selected_ = selected_;
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcFieldInfo fields[] = {
    { "check_", NULL, 0x1, "LRARERenderableDataItem" },
    { "checked_", NULL, 0x1, "LJavaUtilArrayList" },
    { "expand_", NULL, 0x1, "LRARERenderableDataItem" },
    { "expanded_", NULL, 0x1, "LJavaUtilArrayList" },
    { "select_", NULL, 0x1, "LRARERenderableDataItem" },
    { "selected_", NULL, 0x1, "LJavaUtilArrayList" },
  };
  static J2ObjcClassInfo _RAREaPlatformWidget_ItemAttributes = { "ItemAttributes", "com.appnativa.rare.widget", "aPlatformWidget", 0x9, 0, NULL, 6, fields, 0, NULL};
  return &_RAREaPlatformWidget_ItemAttributes;
}

@end
@implementation RAREaPlatformWidget_MenuMouseListener

- (void)mouseReleasedWithRAREMouseEvent:(RAREMouseEvent *)e {
  if ([((RAREMouseEvent *) nil_chk(e)) isPopupTrigger]) {
    RAREaWidget *w = (RAREaWidget *) check_class_cast([e getWidget], [RAREaWidget class]);
    if (w != nil) {
      RAREWidgetListener *l = (RAREWidgetListener *) check_class_cast([w getWidgetListener], [RAREWidgetListener class]);
      if ((l != nil) && [l isEnabledWithNSString:[RAREiConstants EVENT_CONTEXTMENU]]) {
        (void) [l evaluateWithNSString:[RAREiConstants EVENT_CONTEXTMENU] withJavaUtilEventObject:e withBoolean:NO];
      }
      if (![e isConsumed] && [w hasPopupMenu]) {
        [e consume];
        [w showPopupMenuWithInt:0 withInt:0];
      }
    }
  }
}

- (BOOL)wantsLongPress {
  return YES;
}

- (id)init {
  return [super init];
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "wantsLongPress", NULL, "Z", 0x1, NULL },
  };
  static J2ObjcClassInfo _RAREaPlatformWidget_MenuMouseListener = { "MenuMouseListener", "com.appnativa.rare.widget", "aPlatformWidget", 0x8, 1, methods, 0, NULL, 0, NULL};
  return &_RAREaPlatformWidget_MenuMouseListener;
}

@end
