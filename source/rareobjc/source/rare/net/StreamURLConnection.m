//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Code/Dev/appNativa/source/rareobjc/../rare/core/com/appnativa/rare/net/StreamURLConnection.java
//
//  Created by decoteaud on 12/8/15.
//

#include "IOSClass.h"
#include "com/appnativa/rare/net/StreamURLConnection.h"
#include "com/appnativa/rare/util/MIMEMap.h"
#include "com/appnativa/util/Streams.h"
#include "com/appnativa/util/io/BufferedReaderEx.h"
#include "java/io/IOException.h"
#include "java/io/InputStream.h"
#include "java/io/InputStreamReader.h"
#include "java/io/Reader.h"
#include "java/net/URL.h"
#include "java/util/HashMap.h"
#include "java/util/Map.h"

@implementation RAREStreamURLConnection

- (id)initWithJavaNetURL:(JavaNetURL *)url
   withJavaIoInputStream:(JavaIoInputStream *)input
                 withInt:(int)length {
  if (self = [super initWithJavaNetURL:url]) {
    charSet_ = @"ISO-8859-1";
    contentLength_ = -1;
    defaultCharset_ = @"ISO-8859-1";
    self->input_ = input;
    self->contentLength_ = length;
  }
  return self;
}

- (id)initWithJavaNetURL:(JavaNetURL *)url
   withJavaIoInputStream:(JavaIoInputStream *)input
         withJavaUtilMap:(id<JavaUtilMap>)headers {
  if (self = [super initWithJavaNetURL:url]) {
    charSet_ = @"ISO-8859-1";
    contentLength_ = -1;
    defaultCharset_ = @"ISO-8859-1";
    self->input_ = input;
    self->headers_ = headers;
  }
  return self;
}

- (void)close {
  @try {
    [((JavaIoInputStream *) nil_chk(input_)) close];
  }
  @catch (JavaIoIOException *ex) {
  }
}

- (void)connect {
}

- (void)dispose {
  [self close];
}

- (BOOL)exist {
  return YES;
}

- (void)open {
  [self connect];
}

- (void)setCharsetWithNSString:(NSString *)charset {
  self->charSet_ = charset;
}

- (void)setDefaultCharsetWithNSString:(NSString *)charset {
  if (charset == nil) {
    charset = @"ISO-8859-1";
  }
  defaultCharset_ = charset;
}

- (void)setHeaderFieldWithNSString:(NSString *)name
                      withNSString:(NSString *)value {
  if (headers_ == nil) {
    headers_ = [[JavaUtilHashMap alloc] init];
  }
  (void) [((id<JavaUtilMap>) nil_chk(headers_)) putWithId:name withId:value];
}

- (void)setHeadersWithJavaUtilHashMap:(JavaUtilHashMap *)headers {
  self->headers_ = headers;
}

- (NSString *)getCharset {
  return (charSet_ != nil) ? charSet_ : defaultCharset_;
}

- (id)getConnectionObject {
  return self;
}

- (IOSClass *)getConnectionObjectClass {
  return [IOSClass classWithClass:[RAREStreamURLConnection class]];
}

- (NSString *)getContentAsString {
  return [RAREUTStreams readerToStringWithJavaIoReader:[self getReader]];
}

- (int)getContentLength {
  return (contentLength_ > -1) ? contentLength_ : [super getContentLength];
}

- (NSString *)getContentType {
  if (headers_ == nil) {
    if ((contentType_ == nil) && (url_ != nil)) {
      contentType_ = [RAREMIMEMap typeFromFileWithNSString:[url_ getFile]];
    }
    return contentType_;
  }
  return [super getContentType];
}

- (NSString *)getHeaderFieldWithNSString:(NSString *)name {
  return (NSString *) check_class_cast(((headers_ == nil) ? nil : [headers_ getWithId:name]), [NSString class]);
}

- (JavaIoInputStream *)getInputStream {
  return input_;
}

- (JavaIoReader *)getReader {
  if (contentLength_ > 0) {
    return [[RAREUTBufferedReaderEx alloc] initWithJavaIoReader:[[JavaIoInputStreamReader alloc] initWithJavaIoInputStream:input_] withInt:contentLength_];
  }
  return [[RAREUTBufferedReaderEx alloc] initWithJavaIoReader:[[JavaIoInputStreamReader alloc] initWithJavaIoInputStream:input_]];
}

- (int)getResponseCode {
  return 200;
}

- (void)copyAllFieldsTo:(RAREStreamURLConnection *)other {
  [super copyAllFieldsTo:other];
  other->charSet_ = charSet_;
  other->contentLength_ = contentLength_;
  other->contentType_ = contentType_;
  other->defaultCharset_ = defaultCharset_;
  other->headers_ = headers_;
  other->input_ = input_;
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "connect", NULL, "V", 0x1, "JavaIoIOException" },
    { "exist", NULL, "Z", 0x1, NULL },
    { "open", NULL, "V", 0x1, "JavaIoIOException" },
    { "getCharset", NULL, "LNSString", 0x1, "JavaIoIOException" },
    { "getConnectionObject", NULL, "LNSObject", 0x1, NULL },
    { "getConnectionObjectClass", NULL, "LIOSClass", 0x1, NULL },
    { "getContentAsString", NULL, "LNSString", 0x1, "JavaIoIOException" },
    { "getContentType", NULL, "LNSString", 0x1, NULL },
    { "getHeaderFieldWithNSString:", NULL, "LNSString", 0x1, NULL },
    { "getInputStream", NULL, "LJavaIoInputStream", 0x1, "JavaIoIOException" },
    { "getReader", NULL, "LJavaIoReader", 0x1, "JavaIoIOException" },
    { "getResponseCode", NULL, "I", 0x1, "JavaIoIOException" },
  };
  static J2ObjcFieldInfo fields[] = {
    { "charSet_", NULL, 0x0, "LNSString" },
    { "contentLength_", NULL, 0x0, "I" },
    { "headers_", NULL, 0x0, "LJavaUtilMap" },
    { "input_", NULL, 0x0, "LJavaIoInputStream" },
  };
  static J2ObjcClassInfo _RAREStreamURLConnection = { "StreamURLConnection", "com.appnativa.rare.net", NULL, 0x1, 12, methods, 4, fields, 0, NULL};
  return &_RAREStreamURLConnection;
}

@end
