//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Code/Dev/appNativa/source/rareobjc/../rare/core/com/appnativa/rare/net/aNetHelper.java
//
//  Created by decoteaud on 9/15/15.
//

#include "IOSClass.h"
#include "com/appnativa/rare/Platform.h"
#include "com/appnativa/rare/iConstants.h"
#include "com/appnativa/rare/iPlatformAppContext.h"
#include "com/appnativa/rare/net/CollectionURLConnection.h"
#include "com/appnativa/rare/net/InlineURLConnection.h"
#include "com/appnativa/rare/net/ScriptURLConnection.h"
#include "com/appnativa/rare/net/aNetHelper.h"
#include "com/appnativa/rare/viewer/iViewer.h"
#include "com/appnativa/rare/widget/iWidget.h"
#include "java/lang/Exception.h"
#include "java/net/MalformedURLException.h"
#include "java/net/URL.h"
#include "java/net/URLConnection.h"

@implementation RAREaNetHelper

static BOOL RAREaNetHelper_hasStreamHandlerPermission__ = YES;

+ (BOOL *)hasStreamHandlerPermissionRef {
  return &RAREaNetHelper_hasStreamHandlerPermission__;
}

+ (JavaNetURL *)createCollectionURLWithRAREiWidget:(id<RAREiWidget>)context
                                      withNSString:(NSString *)collection {
  id<RAREiPlatformAppContext> app = [((id<RAREiWidget>) nil_chk(context)) getAppContext];
  if (RAREaNetHelper_hasStreamHandlerPermission__) {
    @try {
      return [[JavaNetURL alloc] initWithNSString:[RAREiConstants COLLECTION_PROTOCOL_STRING] withNSString:@"" withInt:0 withNSString:collection withJavaNetURLStreamHandler:[[RAREaNetHelper_CollectionStreamHandler alloc] initWithNSString:collection withRAREiWidget:context]];
    }
    @catch (JavaLangException *e) {
      RAREaNetHelper_hasStreamHandlerPermission__ = NO;
    }
  }
  return [[JavaNetURL alloc] initWithNSString:@"http" withNSString:[RAREiConstants COLLECTION_PROTOCOL_HOSTSTRING] withInt:(int) [((id<RAREiPlatformAppContext>) nil_chk(app)) hash] withNSString:[NSString stringWithFormat:@"%@?%@", collection, [context getPathName]]];
}

+ (JavaNetURL *)createInlineURLWithNSString:(NSString *)data
                               withNSString:(NSString *)mimeType
                               withNSString:(NSString *)enc {
  if (mimeType == nil) {
    mimeType = [RAREiConstants TEXT_MIME_TYPE];
  }
  if (RAREaNetHelper_hasStreamHandlerPermission__) {
    @try {
      return [[JavaNetURL alloc] initWithNSString:[RAREiConstants INLINE_PROTOCOL_STRING] withNSString:@"" withInt:0 withNSString:mimeType withJavaNetURLStreamHandler:[[RAREaNetHelper_InlineStreamHandler alloc] initWithNSString:data withNSString:mimeType withNSString:enc]];
    }
    @catch (JavaLangException *e) {
      RAREaNetHelper_hasStreamHandlerPermission__ = NO;
    }
  }
  NSString *path;
  if (enc != nil) {
    path = [NSString stringWithFormat:@"%@~%@#%@", mimeType, enc, data];
  }
  else {
    path = [NSString stringWithFormat:@"%@#%@", mimeType, data];
  }
  return [[JavaNetURL alloc] initWithNSString:@"http" withNSString:[RAREiConstants INLINE_PROTOCOL_HOSTSTRING] withNSString:path];
}

+ (JavaNetURL *)createScriptURLWithRAREiWidget:(id<RAREiWidget>)context
                                  withNSString:(NSString *)code
                                  withNSString:(NSString *)mimeType {
  if (context == nil) {
    context = [RAREPlatform getContextRootViewer];
  }
  id<RAREiPlatformAppContext> app = [((id<RAREiWidget>) nil_chk(context)) getAppContext];
  if (mimeType == nil) {
    mimeType = [RAREiConstants TEXT_MIME_TYPE];
  }
  if (RAREaNetHelper_hasStreamHandlerPermission__) {
    @try {
      return [[JavaNetURL alloc] initWithNSString:[RAREiConstants SCRIPT_PROTOCOL_STRING] withNSString:[RAREiConstants SCRIPT_PROTOCOL_HOSTSTRING] withInt:[((id<RAREiPlatformAppContext>) nil_chk(app)) getIdentityInt] withNSString:@"" withJavaNetURLStreamHandler:[[RAREaNetHelper_ScriptStreamHandler alloc] initWithRAREiWidget:context withNSString:code withNSString:mimeType]];
    }
    @catch (JavaLangException *e) {
      RAREaNetHelper_hasStreamHandlerPermission__ = NO;
    }
  }
  mimeType = [NSString stringWithFormat:@"~%@@%@?%@", [context getPathName], mimeType, code];
  return [[JavaNetURL alloc] initWithNSString:@"http" withNSString:[RAREiConstants SCRIPT_PROTOCOL_HOSTSTRING] withInt:[((id<RAREiPlatformAppContext>) nil_chk(app)) getIdentityInt] withNSString:mimeType];
}

+ (BOOL)hasStreamHandlerPermission {
  return RAREaNetHelper_hasStreamHandlerPermission__;
}

- (id)init {
  return [super init];
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "createCollectionURLWithRAREiWidget:withNSString:", NULL, "LJavaNetURL", 0x9, "JavaNetMalformedURLException" },
    { "createInlineURLWithNSString:withNSString:withNSString:", NULL, "LJavaNetURL", 0x9, "JavaNetMalformedURLException" },
    { "createScriptURLWithRAREiWidget:withNSString:withNSString:", NULL, "LJavaNetURL", 0x9, "JavaNetMalformedURLException" },
    { "hasStreamHandlerPermission", NULL, "Z", 0x9, NULL },
  };
  static J2ObjcFieldInfo fields[] = {
    { "hasStreamHandlerPermission__", "hasStreamHandlerPermission", 0xc, "Z" },
  };
  static J2ObjcClassInfo _RAREaNetHelper = { "aNetHelper", "com.appnativa.rare.net", NULL, 0x1, 4, methods, 1, fields, 0, NULL};
  return &_RAREaNetHelper;
}

@end
@implementation RAREaNetHelper_CollectionStreamHandler

- (id)initWithNSString:(NSString *)collection
       withRAREiWidget:(id<RAREiWidget>)context {
  if (self = [super init]) {
    self->collectionName_ = collection;
    self->contextWidget_ = context;
  }
  return self;
}

- (JavaNetURLConnection *)openConnectionWithJavaNetURL:(JavaNetURL *)u {
  return [[RARECollectionURLConnection alloc] initWithJavaNetURL:u];
}

- (BOOL)sameFileWithJavaNetURL:(JavaNetURL *)url
                withJavaNetURL:(JavaNetURL *)other {
  return url == other;
}

- (NSString *)toExternalFormWithJavaNetURL:(JavaNetURL *)url {
  return [NSString stringWithFormat:@"%@:///%@?%@", [RAREiConstants COLLECTION_PROTOCOL_STRING], collectionName_, [self getQueryWithJavaNetURL:url]];
}

- (NSString *)toStringWithJavaNetURL:(JavaNetURL *)url {
  return [NSString stringWithFormat:@"%@:///%@?%@", [RAREiConstants COLLECTION_PROTOCOL_STRING], collectionName_, [self getQueryWithJavaNetURL:url]];
}

- (NSString *)getFileWithJavaNetURL:(JavaNetURL *)url {
  return collectionName_;
}

- (NSString *)getHostWithJavaNetURL:(JavaNetURL *)url {
  return [RAREiConstants COLLECTION_PROTOCOL_HOSTSTRING];
}

- (NSString *)getPathWithJavaNetURL:(JavaNetURL *)url {
  return [self getFileWithJavaNetURL:url];
}

- (NSString *)getProtocolWithJavaNetURL:(JavaNetURL *)url {
  return [RAREiConstants COLLECTION_PROTOCOL_STRING];
}

- (NSString *)getQueryWithJavaNetURL:(JavaNetURL *)url {
  return [((id<RAREiWidget>) nil_chk(contextWidget_)) getPathName];
}

- (NSString *)getRefWithJavaNetURL:(JavaNetURL *)url {
  return @"";
}

- (void)copyAllFieldsTo:(RAREaNetHelper_CollectionStreamHandler *)other {
  [super copyAllFieldsTo:other];
  other->collectionName_ = collectionName_;
  other->contextWidget_ = contextWidget_;
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "openConnectionWithJavaNetURL:", NULL, "LJavaNetURLConnection", 0x1, NULL },
    { "sameFileWithJavaNetURL:withJavaNetURL:", NULL, "Z", 0x1, NULL },
    { "toExternalFormWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "toStringWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "getFileWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "getHostWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "getPathWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "getProtocolWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "getQueryWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "getRefWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
  };
  static J2ObjcFieldInfo fields[] = {
    { "collectionName_", NULL, 0x0, "LNSString" },
    { "contextWidget_", NULL, 0x0, "LRAREiWidget" },
  };
  static J2ObjcClassInfo _RAREaNetHelper_CollectionStreamHandler = { "CollectionStreamHandler", "com.appnativa.rare.net", "aNetHelper", 0x8, 10, methods, 2, fields, 0, NULL};
  return &_RAREaNetHelper_CollectionStreamHandler;
}

@end
@implementation RAREaNetHelper_InlineStreamHandler

- (id)initWithNSString:(NSString *)data
          withNSString:(NSString *)mime
          withNSString:(NSString *)enc {
  if (self = [super init]) {
    inlineData_ = data;
    mimeType_ = mime;
    encoding_ = enc;
  }
  return self;
}

- (JavaNetURLConnection *)openConnectionWithJavaNetURL:(JavaNetURL *)u {
  return [[RAREInlineURLConnection alloc] initWithJavaNetURL:u withNSString:inlineData_ withNSString:mimeType_ withNSString:encoding_];
}

- (BOOL)sameFileWithJavaNetURL:(JavaNetURL *)url
                withJavaNetURL:(JavaNetURL *)other {
  return url == other;
}

- (NSString *)toExternalFormWithJavaNetURL:(JavaNetURL *)url {
  return [RAREInlineURLConnection toExternalFormWithJavaNetURL:url];
}

- (NSString *)toStringWithJavaNetURL:(JavaNetURL *)url {
  NSString *data = inlineData_;
  if ([((NSString *) nil_chk(data)) sequenceLength] > 77) {
    data = [NSString stringWithFormat:@"%@...", [data substring:0 endIndex:77]];
  }
  return [NSString stringWithFormat:@"%@:///%@?%@", [RAREiConstants INLINE_PROTOCOL_STRING], mimeType_, data];
}

- (NSString *)getFileWithJavaNetURL:(JavaNetURL *)url {
  return mimeType_;
}

- (NSString *)getHostWithJavaNetURL:(JavaNetURL *)url {
  return [RAREiConstants INLINE_PROTOCOL_HOSTSTRING];
}

- (NSString *)getPathWithJavaNetURL:(JavaNetURL *)url {
  return @"";
}

- (NSString *)getProtocolWithJavaNetURL:(JavaNetURL *)url {
  return [RAREiConstants INLINE_PROTOCOL_STRING];
}

- (NSString *)getQueryWithJavaNetURL:(JavaNetURL *)url {
  return inlineData_;
}

- (NSString *)getRefWithJavaNetURL:(JavaNetURL *)url {
  return @"";
}

- (void)copyAllFieldsTo:(RAREaNetHelper_InlineStreamHandler *)other {
  [super copyAllFieldsTo:other];
  other->encoding_ = encoding_;
  other->inlineData_ = inlineData_;
  other->mimeType_ = mimeType_;
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "openConnectionWithJavaNetURL:", NULL, "LJavaNetURLConnection", 0x1, NULL },
    { "sameFileWithJavaNetURL:withJavaNetURL:", NULL, "Z", 0x1, NULL },
    { "toExternalFormWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "toStringWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "getFileWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "getHostWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "getPathWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "getProtocolWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "getQueryWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "getRefWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
  };
  static J2ObjcFieldInfo fields[] = {
    { "encoding_", NULL, 0x0, "LNSString" },
    { "inlineData_", NULL, 0x0, "LNSString" },
    { "mimeType_", NULL, 0x0, "LNSString" },
  };
  static J2ObjcClassInfo _RAREaNetHelper_InlineStreamHandler = { "InlineStreamHandler", "com.appnativa.rare.net", "aNetHelper", 0x8, 10, methods, 3, fields, 0, NULL};
  return &_RAREaNetHelper_InlineStreamHandler;
}

@end
@implementation RAREaNetHelper_ScriptStreamHandler

- (id)initWithRAREiWidget:(id<RAREiWidget>)context
             withNSString:(NSString *)code
             withNSString:(NSString *)mime {
  if (self = [super init]) {
    contextWidget_ = context;
    scriptCode_ = code;
    mimeType_ = mime;
  }
  return self;
}

- (JavaNetURLConnection *)openConnectionWithJavaNetURL:(JavaNetURL *)u {
  return [[RAREScriptURLConnection alloc] initWithRAREiWidget:contextWidget_ withJavaNetURL:u withNSString:scriptCode_ withNSString:mimeType_];
}

- (BOOL)sameFileWithJavaNetURL:(JavaNetURL *)url
                withJavaNetURL:(JavaNetURL *)other {
  return url == other;
}

- (NSString *)toExternalFormWithJavaNetURL:(JavaNetURL *)url {
  return [NSString stringWithFormat:@"%@:///%@", [RAREiConstants SCRIPT_PROTOCOL_HOSTSTRING], scriptCode_];
}

- (NSString *)toStringWithJavaNetURL:(JavaNetURL *)url {
  return [self toExternalFormWithJavaNetURL:url];
}

- (NSString *)getFileWithJavaNetURL:(JavaNetURL *)url {
  return mimeType_;
}

- (NSString *)getHostWithJavaNetURL:(JavaNetURL *)url {
  return [RAREiConstants SCRIPT_PROTOCOL_HOSTSTRING];
}

- (NSString *)getPathWithJavaNetURL:(JavaNetURL *)url {
  return @"";
}

- (NSString *)getProtocolWithJavaNetURL:(JavaNetURL *)url {
  return [RAREiConstants SCRIPT_PROTOCOL_STRING];
}

- (NSString *)getQueryWithJavaNetURL:(JavaNetURL *)url {
  return @"";
}

- (NSString *)getRefWithJavaNetURL:(JavaNetURL *)url {
  return @"";
}

- (void)copyAllFieldsTo:(RAREaNetHelper_ScriptStreamHandler *)other {
  [super copyAllFieldsTo:other];
  other->contextWidget_ = contextWidget_;
  other->mimeType_ = mimeType_;
  other->scriptCode_ = scriptCode_;
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "openConnectionWithJavaNetURL:", NULL, "LJavaNetURLConnection", 0x1, NULL },
    { "sameFileWithJavaNetURL:withJavaNetURL:", NULL, "Z", 0x1, NULL },
    { "toExternalFormWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "toStringWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "getFileWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "getHostWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "getPathWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "getProtocolWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "getQueryWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
    { "getRefWithJavaNetURL:", NULL, "LNSString", 0x1, NULL },
  };
  static J2ObjcFieldInfo fields[] = {
    { "contextWidget_", NULL, 0x0, "LRAREiWidget" },
    { "mimeType_", NULL, 0x0, "LNSString" },
    { "scriptCode_", NULL, 0x0, "LNSString" },
  };
  static J2ObjcClassInfo _RAREaNetHelper_ScriptStreamHandler = { "ScriptStreamHandler", "com.appnativa.rare.net", "aNetHelper", 0x8, 10, methods, 3, fields, 0, NULL};
  return &_RAREaNetHelper_ScriptStreamHandler;
}

@end
